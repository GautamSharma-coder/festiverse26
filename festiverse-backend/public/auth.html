<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Access Control | Festiverse'26</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <style>
    :root { --bg-dark: #050505; --accent: #ccff00; }
    body { font-family: 'Space Grotesk', sans-serif; background-color: var(--bg-dark); color: white; }
    h1, h2, h3, .font-display { font-family: 'Syne', sans-serif; }
    
    .texture-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.07'/%3E%3C/svg%3E");
      pointer-events: none; z-index: 50;
    }

    .input-field { 
      background: #111; 
      border: 1px solid rgba(255,255,255,0.1); 
      transition: all 0.3s; 
      color: white; 
    }
    .input-field:focus { 
      border-color: var(--accent); 
      outline: none; 
      background: #161616; 
    }
    
    .btn-lime { 
      background: var(--accent); 
      color: black; 
      font-weight: bold; 
      transition: all 0.3s; 
    }
    .btn-lime:hover { 
      background: white; 
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
    }

    /* Tab Switcher Styles */
    .auth-tab {
      border-bottom: 2px solid transparent;
      color: #666;
      transition: all 0.3s;
    }
    .auth-tab.active {
      border-color: var(--accent);
      color: white;
    }

    .hidden-form { display: none; }
    .fade-in { animation: fadeIn 0.4s ease forwards; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="antialiased min-h-screen flex flex-col">
<div class="texture-overlay"></div>

<nav class="absolute top-0 w-full z-40 px-6 py-6 flex justify-between items-center mix-blend-difference">
  <a href="index.html" class="font-display font-bold text-xl tracking-tighter text-white">
    FESTIVERSE<span class="text-[#ccff00]">.</span>
  </a>
  <a href="index.html" class="text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-white transition">Back to Home</a>
</nav>

<main class="flex-grow flex items-center justify-center px-6 relative z-10 py-20">
  
  <div class="w-full max-w-md bg-[#0f0f0f] border border-white/10 rounded-2xl p-8 relative overflow-hidden">
    <div class="absolute top-0 right-0 w-32 h-32 bg-[#ccff00]/10 rounded-full blur-3xl pointer-events-none"></div>

    <div class="text-center mb-8">
      <h2 class="font-display text-3xl font-bold text-white mb-2">ACCESS CONTROL</h2>
      <p class="text-xs text-gray-500 uppercase tracking-widest">Identify Yourself Cadet</p>
    </div>

    <div class="flex mb-8 border-b border-white/10">
      <button onclick="switchMode('login')" id="tab-login" class="auth-tab active flex-1 pb-4 text-sm font-bold uppercase tracking-widest">Login</button>
      <button onclick="switchMode('signup')" id="tab-signup" class="auth-tab flex-1 pb-4 text-sm font-bold uppercase tracking-widest">Sign Up</button>
    </div>

    <form id="form-login" class="fade-in space-y-5">
      <button type="button" onclick="googleAuth()" class="w-full py-3 rounded-lg font-bold font-display uppercase tracking-widest text-xs flex items-center justify-center gap-3 bg-white text-black hover:bg-gray-200 transition-all mb-2">
        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-4 h-4" alt="Google">
        Continue with Google
      </button>

      <div class="flex items-center gap-4">
        <div class="h-px bg-white/10 flex-1"></div>
        <span class="text-[10px] uppercase text-gray-600 font-bold">Or manually</span>
        <div class="h-px bg-white/10 flex-1"></div>
      </div>

      <div>
        <label class="block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2">Email Identity</label>
        <input type="email" id="login-email" placeholder="student@university.edu" class="input-field w-full px-5 py-3 rounded-lg text-sm" required>
      </div>
      
      <div>
        <label class="block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2">Passcode</label>
        <input type="password" id="login-pass" placeholder="••••••••" class="input-field w-full px-5 py-3 rounded-lg text-sm" required>
      </div>

      <div class="flex justify-between items-center text-xs">
        <label class="flex items-center gap-2 cursor-pointer text-gray-400 hover:text-white">
          <input type="checkbox" class="accent-[#ccff00] bg-transparent border-white/20 rounded"> 
          <span>Keep me active</span>
        </label>
        <a href="#" class="text-[#ccff00] hover:underline">Lost Access?</a>
      </div>

      <button type="submit" class="w-full py-4 btn-lime rounded-lg font-bold font-display uppercase tracking-widest text-sm">
        Enter System
      </button>
    </form>

    <form id="form-signup" class="hidden-form space-y-5">
      <button type="button" onclick="googleAuth()" class="w-full py-3 rounded-lg font-bold font-display uppercase tracking-widest text-xs flex items-center justify-center gap-3 bg-white text-black hover:bg-gray-200 transition-all mb-2">
        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-4 h-4" alt="Google">
        Sign Up with Google
      </button>

      <div class="flex items-center gap-4">
        <div class="h-px bg-white/10 flex-1"></div>
        <span class="text-[10px] uppercase text-gray-600 font-bold">Or manually</span>
        <div class="h-px bg-white/10 flex-1"></div>
      </div>

      <div>
        <label class="block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2">Full Name</label>
        <input type="text" id="signup-name" placeholder="Gautam Kumar" class="input-field w-full px-5 py-3 rounded-lg text-sm" required>
      </div>

      <div>
        <label class="block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2">College ID</label>
        <input type="text" id="signup-collegeId" placeholder="U-2026-XYZ" class="input-field w-full px-5 py-3 rounded-lg text-sm" required>
      </div>

      <div>
        <label class="block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2">Email Identity</label>
        <input type="email" id="signup-email" placeholder="student@university.edu" class="input-field w-full px-5 py-3 rounded-lg text-sm" required>
      </div>
      
      <div>
        <label class="block text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-2">Create Passcode</label>
        <input type="password" id="signup-pass" placeholder="••••••••" class="input-field w-full px-5 py-3 rounded-lg text-sm" required>
      </div>

      <button type="submit" class="w-full py-4 btn-lime rounded-lg font-bold font-display uppercase tracking-widest text-sm">
        Register Identity
      </button>
      
      <p class="text-center text-xs text-gray-500">
        By registering, you accept the <a href="#" class="text-white hover:text-[#ccff00] underline">Festiverse Protocols</a>.
      </p>
    </form>

  </div>
</main>

<script>
  // --- TABS LOGIC ---
  function switchMode(mode) {
    const loginForm = document.getElementById('form-login');
    const signupForm = document.getElementById('form-signup');
    const loginTab = document.getElementById('tab-login');
    const signupTab = document.getElementById('tab-signup');

    if (mode === 'login') {
      loginForm.classList.remove('hidden-form');
      loginForm.classList.add('fade-in');
      signupForm.classList.add('hidden-form');
      
      loginTab.classList.add('active');
      signupTab.classList.remove('active');
    } else {
      signupForm.classList.remove('hidden-form');
      signupForm.classList.add('fade-in');
      loginForm.classList.add('hidden-form');
      
      signupTab.classList.add('active');
      loginTab.classList.remove('active');
    }
  }

  // --- GOOGLE AUTH (Simulation - Backend not configured for OAuth yet) ---
  function googleAuth() {
    alert("⚠️ SYSTEM NOTE: Google Protocol offline. Please use manual entry.");
  }

  // --- API HELPER ---
  async function apiRequest(endpoint, data) {
    try {
        const response = await fetch(endpoint, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        return await response.json();
    } catch (err) {
        console.error("Connection Error:", err);
        return { success: false, message: "Server connection failed." };
    }
  }

  // --- LOGIN LOGIC ---
  document.getElementById('form-login').addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = e.target.querySelector('button[type="submit"]');
    const originalText = btn.innerText;
    
    // UI Feedback
    btn.innerText = "AUTHENTICATING...";
    btn.disabled = true;

    // Gather Data
    const email = document.getElementById('login-email').value;
    const password = document.getElementById('login-pass').value;

    // Send Request
    const result = await apiRequest('/api/auth/login', { email, password });

    if (result.success) {
        // Save Session
        localStorage.setItem('userToken', result.token);
        localStorage.setItem('userData', JSON.stringify(result.user));
        
        alert("ACCESS GRANTED. Welcome back.");
        window.location.href = 'dashboard.html'; // Redirect to dashboard
    } else {
        alert("ACCESS DENIED: " + result.message);
        btn.innerText = originalText;
        btn.disabled = false;
    }
  });

  // --- SIGNUP LOGIC ---
  document.getElementById('form-signup').addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = e.target.querySelector('button[type="submit"]');
    const originalText = btn.innerText;
    
    // UI Feedback
    btn.innerText = "INITIALIZING...";
    btn.disabled = true;

    // Gather Data
    const name = document.getElementById('signup-name').value;
    const collegeId = document.getElementById('signup-collegeId').value;
    const email = document.getElementById('signup-email').value;
    const password = document.getElementById('signup-pass').value;

    // Send Request
    const result = await apiRequest('/api/auth/signup', { name, collegeId, email, password });

    if (result.success) {
        // Save Session (Auto-login after signup)
        localStorage.setItem('userToken', result.token);
        localStorage.setItem('userData', JSON.stringify(result.user));
        
        alert("IDENTITY VERIFIED. Welcome to the system.");
        window.location.href = 'dashboard.html'; // Redirect to dashboard
    } else {
        alert("REGISTRATION FAILED: " + result.message);
        btn.innerText = originalText;
        btn.disabled = false;
    }
  });
</script>

</body>
</html>